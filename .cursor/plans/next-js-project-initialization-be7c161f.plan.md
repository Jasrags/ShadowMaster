<!-- be7c161f-35ee-4f90-8e79-0045294866ee faa7cdaf-23a0-4379-9df9-31bff3b5d30a -->
# Next.js 14 Project Initialization & Configuration

This plan implements Prompt 1 from the bootstrap document, setting up the foundation for the Shadowrun VTT application.

## ✅ Status: COMPLETED

**Commit:** `ed1ca63` - "Initialize Next.js 14 project with TypeScript, Tailwind, and Supabase"

All implementation steps have been completed successfully. The project is initialized and ready for development.

## Implementation Steps

### 1. Initialize Next.js Project ✅

- ✅ Manually set up Next.js 14 with TypeScript, Tailwind CSS, App Router, and `src/` directory structure
- ✅ Created all necessary configuration files (tsconfig.json, next.config.js, tailwind.config.ts, postcss.config.js)
- ✅ Set up basic app structure with layout.tsx, page.tsx, and globals.css
- ✅ Configured Tailwind CSS v4 with @tailwindcss/postcss plugin

### 2. Install Core Dependencies ✅

✅ Installed the following npm packages:

- ✅ `@supabase/supabase-js` (v2.86.0)
- ✅ `@supabase/ssr` (v0.8.0) - for Next.js App Router
- ✅ `zustand` (v5.0.9) - state management
- ✅ `react-konva` (v19.2.1) and `konva` (v10.0.12) - canvas rendering
- ✅ `lucide-react` (v0.555.0) - icons
- ✅ `supabase` (v2.65.3) - CLI as dev dependency

### 3. Create Directory Structure ✅

✅ Created the following directory structure under `src/`:

- `app/` - Next.js App Router pages (layout.tsx, page.tsx already created)
- `(auth)/login/` and `(auth)/signup/` - Auth route groups
- `campaigns/` - Campaign management pages
- `characters/` - Character management pages
- `play/` - VTT play session pages
- `components/` - React components
- `ui/` - Intent UI components (placeholder for Prompt 6)
- `game/` - Game-specific components
- `vtt/` - VTT canvas components
- `lib/` - Utility libraries
- `supabase/` - Supabase client configuration
- `stores/` - Zustand stores
- `utils/` - General utilities
- `types/` - TypeScript type definitions
- `styles/` - Additional stylesheets

### 4. Environment Variables ✅

✅ Created `.env.local` template with:

- ✅ `NEXT_PUBLIC_SUPABASE_URL=`
- ✅ `NEXT_PUBLIC_SUPABASE_ANON_KEY=`
- ✅ `SUPABASE_SERVICE_ROLE_KEY=`

✅ Created `.env.example` with the same structure for documentation.

### 5. Docker Configuration ✅

✅ **Dockerfile**: Multi-stage build created with:

- ✅ Stage 1: Dependencies (Node 20 Alpine, install npm packages)
- ✅ Stage 2: Builder (copy source, build Next.js with standalone output)
- ✅ Stage 3: Runner (minimal Node 20 Alpine, copy standalone build, non-root user, health check)
- ✅ **.dockerignore**: Created to exclude node_modules, .next, .git, and development files
- ✅ **Health check endpoint**: Created `src/app/api/health/route.ts` for Docker health checks
- ✅ Created empty `public/` directory for Docker builds

### 6. Supabase Local Development ✅

- ✅ Initialized Supabase CLI in the project (`supabase init`)
- ✅ Created `supabase/` directory with config.toml
- ✅ docker-compose.yml will be generated automatically when `supabase start` is run
- ✅ Added npm scripts to start/stop local Supabase

### 7. Update .gitignore ✅

✅ Added standard Next.js and development exclusions:

- ✅ `.next/`, `.env*.local`, `node_modules/`, etc.
- ✅ Supabase-specific exclusions (.branches, .temp)
- ✅ TypeScript build info and other development files

### 8. Package.json Scripts ✅

✅ Added the following scripts:

- ✅ `dev` - Local development
- ✅ `build` - Production build
- ✅ `start` - Start production server
- ✅ `lint` - Run ESLint
- ✅ `docker:build` - Build Docker image
- ✅ `docker:run` - Run Docker container
- ✅ `supabase:start` - Start local Supabase (using Supabase CLI)
- ✅ `supabase:stop` - Stop local Supabase

### 9. Tailwind Configuration ✅

- ✅ Created `tailwind.config.ts` with proper configuration
- ✅ Configured for `src/` directory structure (content paths include src/app, src/components, src/pages)
- ✅ Set up Tailwind CSS v4 with `@tailwindcss/postcss` plugin
- ✅ Updated `globals.css` to use v4 syntax (`@import "tailwindcss"`)
- ✅ No additional Intent UI config needed initially (as per prompt)

## Files to Create/Modify

**New Files:**

- `.env.local` (template)
- `.env.example`
- `Dockerfile`
- `.dockerignore`
- `src/app/api/health/route.ts`
- Directory structure (empty directories with placeholder files or `.gitkeep`)

**Modified Files:**

- `package.json` (add dependencies and scripts)
- `.gitignore` (add Next.js exclusions)

**Generated by Tools:**

- `supabase/` directory and `docker-compose.yml` (via Supabase CLI)

## Notes

- ✅ Supabase CLI will handle the docker-compose.yml for local development automatically
- ✅ The project structure uses `src/` directory as specified
- ✅ All TypeScript configuration is properly set up
- ✅ Tailwind CSS v4 is configured and working
- ✅ Project uses Docker Desktop (Colima-specific changes were reverted)
- ✅ All files committed to git (commit: ed1ca63)

## Additional Notes

- Fixed Tailwind CSS v4 compatibility by installing `@tailwindcss/postcss` and updating PostCSS config
- Created empty `public/` directory to fix Docker build issues
- Configured for Docker Desktop (removed Colima-specific configurations)

### To-dos

- [x] Initialize Next.js 14 project with create-next-app (TypeScript, Tailwind, App Router, src/ directory)
- [x] Install core dependencies: @supabase/supabase-js, @supabase/ssr, zustand, react-konva, konva, lucide-react
- [x] Create complete directory structure under src/ (app routes, components, lib, types, styles)
- [x] Create .env.local template and .env.example with Supabase environment variables
- [x] Create multi-stage Dockerfile with Node 20 Alpine, proper caching, non-root user, and health check
- [x] Create .dockerignore and update .gitignore with appropriate exclusions
- [x] Initialize Supabase CLI (creates supabase/ directory and docker-compose.yml)
- [x] Create /api/health route for Docker health checks
- [x] Add npm scripts for docker:build, docker:run, supabase:start, supabase:stop