<!-- be7c161f-35ee-4f90-8e79-0045294866ee faa7cdaf-23a0-4379-9df9-31bff3b5d30a -->
# Next.js 14 Project Initialization & Configuration

This plan implements Prompt 1 from the bootstrap document, setting up the foundation for the Shadowrun VTT application.

## Implementation Steps

### 1. Initialize Next.js Project

- Run `create-next-app` with TypeScript, Tailwind CSS, App Router, and `src/` directory structure
- Project will be initialized in the current directory (ShadowMaster)

### 2. Install Core Dependencies

Install the following npm packages:

- `@supabase/supabase-js` (latest)
- `@supabase/ssr` (for Next.js App Router)
- `zustand` (state management)
- `react-konva` and `konva` (canvas rendering)
- `lucide-react` (icons)

### 3. Create Directory Structure

Create the following directory structure under `src/`:

- `app/` - Next.js App Router pages (layout.tsx, page.tsx already created)
- `(auth)/login/` and `(auth)/signup/` - Auth route groups
- `campaigns/` - Campaign management pages
- `characters/` - Character management pages
- `play/` - VTT play session pages
- `components/` - React components
- `ui/` - Intent UI components (placeholder for Prompt 6)
- `game/` - Game-specific components
- `vtt/` - VTT canvas components
- `lib/` - Utility libraries
- `supabase/` - Supabase client configuration
- `stores/` - Zustand stores
- `utils/` - General utilities
- `types/` - TypeScript type definitions
- `styles/` - Additional stylesheets

### 4. Environment Variables

Create `.env.local` template with:

- `NEXT_PUBLIC_SUPABASE_URL=`
- `NEXT_PUBLIC_SUPABASE_ANON_KEY=`
- `SUPABASE_SERVICE_ROLE_KEY=`

Create `.env.example` with the same structure (without values) for documentation.

### 5. Docker Configuration

- **Dockerfile**: Multi-stage build with:
- Stage 1: Dependencies (Node 20 Alpine, install npm packages)
- Stage 2: Builder (copy source, build Next.js with standalone output)
- Stage 3: Runner (minimal Node 20 Alpine, copy standalone build, non-root user, health check)
- **.dockerignore**: Exclude node_modules, .next, .git, and development files
- **Health check endpoint**: Create `src/app/api/health/route.ts` for Docker health checks

### 6. Supabase Local Development

- Initialize Supabase CLI in the project (`supabase init`)
- This will create `supabase/` directory with config and generate docker-compose.yml automatically
- Add npm scripts to start/stop local Supabase

### 7. Update .gitignore

Add standard Next.js and development exclusions:

- `.next/`, `.env*.local`, `node_modules/`, etc.
- Keep existing `node_modules` entry

### 8. Package.json Scripts

Add the following scripts:

- `dev` - Local development (already exists, verify it works)
- `build` - Production build (already exists)
- `start` - Start production server (already exists)
- `docker:build` - Build Docker image
- `docker:run` - Run Docker container
- `supabase:start` - Start local Supabase (using Supabase CLI)
- `supabase:stop` - Stop local Supabase

### 9. Tailwind Configuration

- Verify `tailwind.config.ts` exists (created by create-next-app)
- Ensure it's configured for `src/` directory structure
- No additional Intent UI config needed initially (as per prompt)

## Files to Create/Modify

**New Files:**

- `.env.local` (template)
- `.env.example`
- `Dockerfile`
- `.dockerignore`
- `src/app/api/health/route.ts`
- Directory structure (empty directories with placeholder files or `.gitkeep`)

**Modified Files:**

- `package.json` (add dependencies and scripts)
- `.gitignore` (add Next.js exclusions)

**Generated by Tools:**

- `supabase/` directory and `docker-compose.yml` (via Supabase CLI)

## Notes

- Supabase CLI will handle the docker-compose.yml for local development automatically
- The project structure uses `src/` directory as specified
- All TypeScript configuration will be handled by create-next-app
- Tailwind CSS will be pre-configured by create-next-app

### To-dos

- [ ] Initialize Next.js 14 project with create-next-app (TypeScript, Tailwind, App Router, src/ directory)
- [ ] Install core dependencies: @supabase/supabase-js, @supabase/ssr, zustand, react-konva, konva, lucide-react
- [ ] Create complete directory structure under src/ (app routes, components, lib, types, styles)
- [ ] Create .env.local template and .env.example with Supabase environment variables
- [ ] Create multi-stage Dockerfile with Node 20 Alpine, proper caching, non-root user, and health check
- [ ] Create .dockerignore and update .gitignore with appropriate exclusions
- [ ] Initialize Supabase CLI (creates supabase/ directory and docker-compose.yml)
- [ ] Create /api/health route for Docker health checks
- [ ] Add npm scripts for docker:build, docker:run, supabase:start, supabase:stop